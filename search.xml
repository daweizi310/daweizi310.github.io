<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>mysql数据库每日备份脚本编写(Linux系统)</title>
      <link href="/2019/07/29/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%AF%8F%E6%97%A5%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99-Linux%E7%B3%BB%E7%BB%9F/"/>
      <url>/2019/07/29/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%AF%8F%E6%97%A5%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99-Linux%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="mysql数据库每日备份脚本编写-Linux系统"><a href="#mysql数据库每日备份脚本编写-Linux系统" class="headerlink" title="mysql数据库每日备份脚本编写(Linux系统)"></a>mysql数据库每日备份脚本编写(Linux系统)</h1><h2 id="1-先在系统创建一个文件夹存放复制的sql文件"><a href="#1-先在系统创建一个文件夹存放复制的sql文件" class="headerlink" title="1: 先在系统创建一个文件夹存放复制的sql文件"></a>1: 先在系统创建一个文件夹存放复制的sql文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如: 在 /root 下创建一个 mysqlData文件夹</span><br><span class="line">mkdir mysqlData</span><br></pre></td></tr></table></figure><h2 id="2-在mysqlData下再创建一个文件夹-sql"><a href="#2-在mysqlData下再创建一个文件夹-sql" class="headerlink" title="2: 在mysqlData下再创建一个文件夹 sql"></a>2: 在mysqlData下再创建一个文件夹 sql</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1: 创建复制数据库sql脚本;再授执行权限</span><br><span class="line">--&gt;touch backupMysql.sh</span><br><span class="line">--&gt;chmod 777 backupMysql.sh</span><br></pre></td></tr></table></figure><h2 id="3-编写脚本内容"><a href="#3-编写脚本内容" class="headerlink" title="3: 编写脚本内容"></a>3: 编写脚本内容</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1: 编写backupMysql.sh</span><br><span class="line">--&gt; vi backupMysql.sh</span><br><span class="line">************下面的是写的内容*********************</span><br><span class="line">#!/bin/bash</span><br><span class="line">date=$(date +%Y%m%d-%H%M%S)</span><br><span class="line">#!/bin/bash</span><br><span class="line">mysqldump -hlocalhost -uroot -p123456 (数据库名) &gt; /root/st-automation/mysqlData/st_automation_$&#123;date&#125;.sql</span><br><span class="line">mysqldump -hlocalhost -uroot -p123456 (数据库名) | gzip &gt; /root/st-automation/mysqlData/st_automation_$&#123;date&#125;.sql.gz</span><br><span class="line">#!/bin/bash</span><br><span class="line">cp /root/st-automation/mysqlData/st_automation_$&#123;date&#125;.sql  /mnt/public_share/研发部/测试部/软件测试/ST-DTW/QT-BackUp/maxton/st_automation$&#123;date&#125;.sql</span><br><span class="line">mysqldump -hlocalhost -uroot -p123456 st_automation | gzip &gt; /mnt/public_share/研发部/测试部/软件测试/ST-DTW/QT-BackUp/maxton/st_automation$&#123;date&#125;.sql.gz</span><br><span class="line">#!/bin/bash</span><br><span class="line">find /root/st-automation/mysqlData/ -mtime +30 -name &quot;st_automation_*&quot; -exec rm -rf &#123;&#125; \;</span><br><span class="line"> *************编写结束**************************</span><br><span class="line"> 说明下:</span><br><span class="line"> a:date=$(date +%Y%m%d-%H%M%S)这个是获取当前系统的时间;格式为 2019718-143023</span><br><span class="line">   表示14点30分23秒</span><br><span class="line"> b: mysqldump -hlocalhost -uroot -p123456 --databases XXX &gt; /root/(路径)/XXX_$&#123;date&#125;.sql</span><br><span class="line"> localhost:主机ip,本地就用localhost</span><br><span class="line"> root : 用户</span><br><span class="line"> 123456 : 密码</span><br><span class="line"> XXX : 需要备份的数据库名称</span><br><span class="line"> /root/st-automation/mysqlData/XXX_$&#123;date&#125;.sql : 生成的文件存放目录;XXX最后与数据库名一样;好辨认;</span><br><span class="line"> /mnt/public_share...是挂载的共享路径(如何挂载,搜索Linux挂载Windows共享方法)</span><br><span class="line"> cp 复制到共享</span><br><span class="line"> | gzip 生成压缩文件</span><br><span class="line"> 实际生成的文件格式: st-automation_20190718-141401.sql;</span><br><span class="line"> find /root/st-automation/mysqlData/ -mtime +7 -name &quot;lanqiao_*&quot; -exec rm -rf &#123;&#125; \;</span><br><span class="line"> /root/st-automation/mysqlData/: 生成文件的目录</span><br><span class="line"> +7 : 7天前; 若要30天的;就是+30</span><br><span class="line"> &quot;st-automation_*&quot; : 文件名匹配</span><br><span class="line"> 后面就是执行删除命令;</span><br><span class="line"> 意思就是删除7天前生成的sql文件;只保留7天;如果要保留30天,就是+30;</span><br></pre></td></tr></table></figure><h2 id="4-将脚本放入系统任务里执行"><a href="#4-将脚本放入系统任务里执行" class="headerlink" title="4: 将脚本放入系统任务里执行"></a>4: 将脚本放入系统任务里执行</h2><h3 id="1-打开系统任务-起始为空-centos7默认自启动这个任务"><a href="#1-打开系统任务-起始为空-centos7默认自启动这个任务" class="headerlink" title="1: 打开系统任务;起始为空;centos7默认自启动这个任务"></a>1: 打开系统任务;起始为空;centos7默认自启动这个任务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&gt; crontab -e</span><br></pre></td></tr></table></figure><h3 id="2-写定时任务-来执行脚本"><a href="#2-写定时任务-来执行脚本" class="headerlink" title="2: 写定时任务,来执行脚本"></a>2: 写定时任务,来执行脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">每天执行</span><br><span class="line">0 0 * * * /root/st-automation/mysqlData/backupMysql.sh</span><br><span class="line">每分钟执行</span><br><span class="line">*/1 * * * * /root/st-automation/mysqlData/backupMysql.sh</span><br><span class="line">每两小时执行一次</span><br><span class="line">* */2 * * * /root/st-automation/mysqlData/backupMysql.sh</span><br><span class="line">写完退出保存; 按esc 退出编辑,然后 :wq 执行保存</span><br><span class="line">然后将系统任务重启</span><br><span class="line">service crond restart</span><br></pre></td></tr></table></figure><h3 id="3-测试执行"><a href="#3-测试执行" class="headerlink" title="3: 测试执行"></a>3: 测试执行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">测试: 你可以先设置每分钟执行</span><br><span class="line">  */1 * * * * /root/st-automation/mysqlData/backupMysql.sh</span><br><span class="line">      然后在/root/st-automation/mysqlData下观察是不是每分钟都会生成一个sql文件;</span><br><span class="line">      注意: 执行 crontab -e ;修改了文件后;需要重启文件才生效; service crond restart</span><br><span class="line">      </span><br><span class="line">      生成之后也可以将原来mysql中的需要备份数据库删除;</span><br><span class="line">      然后进行mysql;需要登录mysql执行下面命令;</span><br><span class="line">      执行 source /usr/mysqlData/XXX.sql;就可以根据sql文件生成原来备份的数据库</span><br><span class="line">测试: 在/root/st-automation/mysqlData路径下,手动执行 ./ backupMysql.sh </span><br><span class="line">  然后在/root/st-automation/mysqlData下观察是不是会生成一个sql文件;</span><br></pre></td></tr></table></figure><h3 id="4-备注"><a href="#4-备注" class="headerlink" title="4:备注"></a>4:备注</h3><p>a：这里设置了本地备份和公司共享磁盘备份,防止机器或系统故障,磁盘无法打开</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hexo个人博客搭建流程</title>
      <link href="/2019/07/29/hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%B5%81%E7%A8%8B/"/>
      <url>/2019/07/29/hexo%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>一顿操作猛如虎</p><p>创建过程整理中,整理好会放上去</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>入门博客</title>
      <link href="/2019/07/29/hello-world/"/>
      <url>/2019/07/29/hello-world/</url>
      
        <content type="html"><![CDATA[<h2 id="入门第一篇博客"><a href="#入门第一篇博客" class="headerlink" title="入门第一篇博客"></a>入门第一篇博客</h2><p><a href="http://daweizi.top">http://daweizi.top</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
